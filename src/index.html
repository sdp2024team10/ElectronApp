<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="../node_modules/mathquill/build/mathquill.css">
  <script type="text/javascript" src="../src/jquery1.7.2.min.js"></script>
  <script type="text/javascript" src="../node_modules/mathquill/build/mathquill.js"></script>
</head>
<body>

  <div id="math-fields-container">
    <!-- Container for math fields -->
  </div>
  <button id="add-math-field">Add Math Field</button>

  <script>
    var MQ = MathQuill.getInterface(2);
    var mathFields = []; // Array to store math field objects
    var latexStrings = []; // Array to store LaTeX strings

    // Function to create a new math field
    function createMathField() {
      var fieldContainer = document.createElement('div');
      var mathFieldSpan = document.createElement('span');
      var latexSpan = document.createElement('code');

      fieldContainer.appendChild(mathFieldSpan);
      fieldContainer.appendChild(latexSpan);
      document.getElementById('math-fields-container').appendChild(fieldContainer);

      var mathField = MQ.MathField(mathFieldSpan, {
        spaceBehavesLikeTab: true,
        handlers: {
          edit: function() {
            var latex = mathField.latex();
            latexSpan.textContent = latex;
            updateLatexInMemory(mathField, latex);
          }
        }
      });

      mathFields.push(mathField);
    }

    // Function to update LaTeX string in memory
    function updateLatexInMemory(mathField, latex) {
      var index = mathFields.indexOf(mathField);
      latexStrings[index] = latex;
    }

    // Event listener for button
    document.getElementById('add-math-field').addEventListener('click', function() {
      createMathField();
    });
  </script>
</body>
</html>
